{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "basics-agent",
  "type": "registry:block",
  "description": "Multi-step AI agent with up to 5 tool-calling iterations using the Vercel AI SDK.",
  "dependencies": [
    "ai",
    "@ai-sdk/openai",
    "zod"
  ],
  "devDependencies": [],
  "registryDependencies": [],
  "files": [
    {
      "path": "app/page.tsx",
      "type": "registry:page",
      "target": "app/page.tsx",
      "content": "import type { Metadata } from \"next\"\nimport { AgentDemo } from \"@/components/agent-demo\"\n\nexport const metadata: Metadata = {\n  title: \"Agent Loop — AI SDK Demo\",\n  description: \"Multi-step AI agent with tool calling using the Vercel AI SDK.\",\n}\n\nexport default function Page() {\n  return (\n    <main className=\"flex min-h-svh flex-col items-center justify-center bg-background px-4 py-12\">\n      <AgentDemo />\n    </main>\n  )\n}\n"
    },
    {
      "path": "app/layout.tsx",
      "type": "registry:page",
      "target": "app/layout.tsx",
      "content": "import type { Metadata } from \"next\"\nimport { Inter } from \"next/font/google\"\nimport type { ReactNode } from \"react\"\nimport { cn } from \"@/lib/utils\"\n\nconst inter = Inter({ subsets: [\"latin\"] })\n\nexport const metadata: Metadata = {\n  title: \"Agent Loop — AI SDK Demo\",\n  description: \"Multi-step AI agent with tool calling using the Vercel AI SDK.\",\n}\n\nexport default function RootLayout({ children }: { children: ReactNode }) {\n  return (\n    <html lang=\"en\" suppressHydrationWarning>\n      <body className={cn(\"min-h-svh bg-background font-sans antialiased\", inter.className)}>\n        {children}\n      </body>\n    </html>\n  )\n}\n"
    },
    {
      "path": "app/api/agent/route.ts",
      "type": "registry:file",
      "target": "app/api/agent/route.ts",
      "content": "import { generateText, tool } from \"ai\"\nimport { openai } from \"@ai-sdk/openai\"\nimport { z } from \"zod\"\n\nexport async function POST(req: Request) {\n  try {\n    const { prompt } = await req.json()\n\n    if (!prompt || typeof prompt !== \"string\") {\n      return Response.json({ error: \"prompt is required\" }, { status: 400 })\n    }\n\n    const { text, steps } = await generateText({\n      model: openai(\"gpt-4o\"),\n      maxSteps: 5,\n      prompt,\n      tools: {\n        search: tool({\n          description: \"Search the web for information on a topic\",\n          parameters: z.object({\n            query: z.string().describe(\"The search query\"),\n          }),\n          execute: async ({ query }) =>\n            `Simulated search results for \"${query}\": Found 3 relevant articles about recent developments.`,\n        }),\n        analyze: tool({\n          description: \"Analyze and synthesize information\",\n          parameters: z.object({\n            content: z.string().describe(\"Content to analyze\"),\n            focus: z.string().describe(\"What aspect to focus on\"),\n          }),\n          execute: async ({ content, focus }) =>\n            `Analysis focusing on \"${focus}\": ${content.slice(0, 150)}...`,\n        }),\n      },\n    })\n\n    const serializedSteps = steps.map((step) => ({\n      toolCalls: step.toolCalls?.map((tc) => ({\n        toolName: tc.toolName,\n        args: tc.args,\n      })),\n    }))\n\n    return Response.json({ text, stepCount: steps.length, steps: serializedSteps })\n  } catch (error) {\n    console.error(\"[agent]\", error)\n    return Response.json({ error: \"Agent execution failed\" }, { status: 500 })\n  }\n}\n"
    },
    {
      "path": "components/agent-demo.tsx",
      "type": "registry:component",
      "target": "components/agent-demo.tsx",
      "content": "\"use client\"\n\nimport { useState } from \"react\"\n\ninterface StepToolCall {\n  toolName: string\n  args: Record<string, unknown>\n}\n\ninterface AgentStep {\n  toolCalls?: StepToolCall[]\n}\n\ninterface AgentResult {\n  text: string\n  stepCount: number\n  steps: AgentStep[]\n}\n\nexport function AgentDemo() {\n  const [prompt, setPrompt] = useState(\n    \"Research the current state of AI agents and give me a concise summary.\"\n  )\n  const [result, setResult] = useState<AgentResult | null>(null)\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState<string | null>(null)\n\n  async function handleSubmit(e: React.FormEvent<HTMLFormElement>) {\n    e.preventDefault()\n    if (!prompt.trim() || loading) return\n\n    setLoading(true)\n    setResult(null)\n    setError(null)\n\n    try {\n      const res = await fetch(\"/api/agent\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ prompt: prompt.trim() }),\n      })\n      if (!res.ok) throw new Error(await res.text())\n      setResult(await res.json())\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"Agent failed\")\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <div className=\"mx-auto w-full max-w-lg space-y-6\">\n      <div>\n        <h1 className=\"text-xl font-semibold tracking-tight\">Agent Loop</h1>\n        <p className=\"mt-1 text-sm text-muted-foreground\">\n          Multi-step agent with up to 5 tool-calling iterations.\n        </p>\n      </div>\n\n      <form onSubmit={handleSubmit} className=\"space-y-3\">\n        <textarea\n          value={prompt}\n          onChange={(e) => setPrompt(e.target.value)}\n          rows={3}\n          className=\"w-full resize-none rounded-lg border border-input bg-transparent px-3 py-2 text-sm outline-none placeholder:text-muted-foreground/60 focus-visible:ring-2 focus-visible:ring-ring\"\n        />\n        <button\n          type=\"submit\"\n          disabled={loading || !prompt.trim()}\n          className=\"inline-flex h-9 items-center justify-center rounded-lg bg-primary px-4 text-sm font-medium text-primary-foreground transition-colors hover:bg-primary/90 disabled:cursor-not-allowed disabled:opacity-50\"\n        >\n          {loading ? (\n            <span className=\"flex items-center gap-2\">\n              <svg className=\"size-4 animate-spin\" viewBox=\"0 0 24 24\" fill=\"none\">\n                <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" />\n                <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z\" />\n              </svg>\n              Running agent…\n            </span>\n          ) : (\n            \"Run Agent\"\n          )}\n        </button>\n      </form>\n\n      {error && (\n        <div className=\"rounded-lg border border-destructive/30 bg-destructive/5 px-3 py-2.5\">\n          <p className=\"text-sm text-destructive\">{error}</p>\n        </div>\n      )}\n\n      {result && (\n        <div className=\"space-y-4\">\n          <div className=\"flex items-center gap-2\">\n            <p className=\"text-[11px] font-semibold uppercase tracking-wider text-muted-foreground/50\">\n              Execution Trace\n            </p>\n            <span className=\"rounded-full bg-muted px-2 py-0.5 font-mono text-[10px] text-muted-foreground\">\n              {result.stepCount} steps\n            </span>\n          </div>\n\n          <div className=\"space-y-2\">\n            {result.steps.map((step, i) => (\n              <div key={i} className=\"rounded-lg border bg-muted/20 p-3\">\n                <p className=\"mb-1.5 text-[11px] font-semibold text-muted-foreground/50\">\n                  Step {i + 1}\n                </p>\n                {step.toolCalls?.map((tc, j) => (\n                  <div key={j} className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                    <span className=\"rounded bg-foreground/10 px-1.5 py-0.5 font-mono font-medium text-foreground/70\">\n                      {tc.toolName}\n                    </span>\n                    <span className=\"truncate text-muted-foreground/60\">\n                      {JSON.stringify(tc.args)}\n                    </span>\n                  </div>\n                ))}\n              </div>\n            ))}\n          </div>\n\n          <div className=\"rounded-lg border bg-muted/40 px-4 py-3\">\n            <p className=\"mb-2 text-[13px] font-medium text-muted-foreground/60\">Final Response</p>\n            <p className=\"text-sm leading-relaxed text-foreground/85\">{result.text}</p>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n"
    }
  ]
}